<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title></title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<p>Poker Rule Induction Kaggle competition</p>

<p>#<a href="https://www.kaggle.com/c/poker-rule-induction">https://www.kaggle.com/c/poker-rule-induction</a></p>

<p>This competition tasks entrants with classifying poker hands based on a sample of 25010 labeled hands. The data is separated into 10 features, indicating the suit and rank of each card. Cards are not given in any particular order. The difficulty is learning rules without making any assumptions about the rules and using domain knowledge to guide learning. Of course it would be easy to sort cards, calculate combinations or hard code poker rules to achieve good results, but the challenge states that you are to act as though you are an alien that doesn&#39;t know anything about poker or card games. The methods used are supposed to be general enough to apply to completely different card games with different rules. Several entrants are scoring 99% or above in accuracy, which suggests that people are injecting domain knowledge into solutions. My aim is to run a few basic machine learning algorithms on the raw data without making any assumptions and beat the competition given random forest benchmark accuracy of 0.62408.  </p>

<p>I Start by loading some machine learning libraries.</p>

<pre><code class="r">library(caret)
</code></pre>

<pre><code>## Loading required package: lattice
## Loading required package: ggplot2
</code></pre>

<pre><code class="r">library(randomForest)
</code></pre>

<pre><code>## randomForest 4.6-10
## Type rfNews() to see new features/changes/bug fixes.
</code></pre>

<pre><code class="r">library(gbm)
</code></pre>

<pre><code>## Loading required package: survival
## Loading required package: splines
## 
## Attaching package: &#39;survival&#39;
## 
## The following object is masked from &#39;package:caret&#39;:
## 
##     cluster
## 
## Loading required package: parallel
## Loaded gbm 2.1
</code></pre>

<pre><code class="r">options( java.parameters = &quot;-Xmx3g&quot; )
library(extraTrees)
</code></pre>

<pre><code>## Loading required package: rJava
</code></pre>

<p>Next I read in the training and test data</p>

<pre><code class="r">train = read.csv(&quot;train.csv&quot;)
test = read.csv(&quot;test.csv&quot;)
#Get rid of ID column
test = test[,2:11]

#Separate labels from training set
labels = as.factor(train$hand)
train = train[,1:10]

#Split training set into partial training set and validation set
part_train = train[1:18000,]
valid = train[-1:-18000,]

labels_part = labels[1:18000]
valid_labels = labels[-1:-18000]
</code></pre>

<p>First I run a random forest model</p>

<pre><code class="r">set.seed(12)
tree = randomForest(labels_part~., data=part_train, nodesize=1, ntree=500, mtry=4)

tree_pred = predict(tree, newdata=valid, type=&quot;class&quot;)

confusionMatrix(tree_pred,valid_labels)
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    0    1    2    3    4    5    6    7    8    9
##          0 2819 1465   78   22    0   12    0    1    0    0
##          1  699 1499  262  107   24    2   11    1    4    1
##          2    0    0    0    2    0    0    0    0    0    0
##          3    0    0    0    1    0    0    0    0    0    0
##          4    0    0    0    0    0    0    0    0    0    0
##          5    0    0    0    0    0    0    0    0    0    0
##          6    0    0    0    0    0    0    0    0    0    0
##          7    0    0    0    0    0    0    0    0    0    0
##          8    0    0    0    0    0    0    0    0    0    0
##          9    0    0    0    0    0    0    0    0    0    0
## 
## Overall Statistics
##                                         
##                Accuracy : 0.616         
##                  95% CI : (0.605, 0.628)
##     No Information Rate : 0.502         
##     P-Value [Acc &gt; NIR] : &lt;2e-16        
##                                         
##                   Kappa : 0.273         
##  Mcnemar&#39;s Test P-Value : NA            
## 
## Statistics by Class:
## 
##                      Class: 0 Class: 1 Class: 2 Class: 3 Class: 4 Class: 5
## Sensitivity             0.801    0.506 0.000000 0.007576  0.00000    0.000
## Specificity             0.548    0.725 0.999700 1.000000  1.00000    1.000
## Pos Pred Value          0.641    0.574 0.000000 1.000000      NaN      NaN
## Neg Pred Value          0.732    0.667 0.951484 0.981310  0.99658    0.998
## Prevalence              0.502    0.423 0.048502 0.018830  0.00342    0.002
## Detection Rate          0.402    0.214 0.000000 0.000143  0.00000    0.000
## Detection Prevalence    0.627    0.372 0.000285 0.000143  0.00000    0.000
## Balanced Accuracy       0.675    0.616 0.499850 0.503788  0.50000    0.500
##                      Class: 6 Class: 7 Class: 8 Class: 9
## Sensitivity           0.00000 0.000000 0.000000 0.000000
## Specificity           1.00000 1.000000 1.000000 1.000000
## Pos Pred Value            NaN      NaN      NaN      NaN
## Neg Pred Value        0.99843 0.999715 0.999429 0.999857
## Prevalence            0.00157 0.000285 0.000571 0.000143
## Detection Rate        0.00000 0.000000 0.000000 0.000000
## Detection Prevalence  0.00000 0.000000 0.000000 0.000000
## Balanced Accuracy     0.50000 0.500000 0.500000 0.500000
</code></pre>

<p>Accuracy of 0.6161. Slightly lower than the benchmark.</p>

<p>Next I try an extra trees classifier.</p>

<pre><code class="r">set.seed(12)
xtrees = extraTrees(y=labels_part, x=part_train, nodesize=1, ntree=500, mtry=4, numRandomCuts = 3)

xtrees_pred = predict(xtrees, newdata=valid)

confusionMatrix(xtrees_pred,valid_labels)
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    0    1    2    3    4    5    6    7    8    9
##          0 2749 1488   80   23    2   12    1    1    0    0
##          1  768 1470  260  106   22    2   10    1    4    1
##          2    1    4    0    1    0    0    0    0    0    0
##          3    0    2    0    2    0    0    0    0    0    0
##          4    0    0    0    0    0    0    0    0    0    0
##          5    0    0    0    0    0    0    0    0    0    0
##          6    0    0    0    0    0    0    0    0    0    0
##          7    0    0    0    0    0    0    0    0    0    0
##          8    0    0    0    0    0    0    0    0    0    0
##          9    0    0    0    0    0    0    0    0    0    0
## 
## Overall Statistics
##                                         
##                Accuracy : 0.602         
##                  95% CI : (0.591, 0.614)
##     No Information Rate : 0.502         
##     P-Value [Acc &gt; NIR] : &lt;2e-16        
##                                         
##                   Kappa : 0.247         
##  Mcnemar&#39;s Test P-Value : NA            
## 
## Statistics by Class:
## 
##                      Class: 0 Class: 1 Class: 2 Class: 3 Class: 4 Class: 5
## Sensitivity             0.781    0.496 0.000000 0.015152  0.00000    0.000
## Specificity             0.540    0.710 0.999100 0.999709  1.00000    1.000
## Pos Pred Value          0.631    0.556 0.000000 0.500000      NaN      NaN
## Neg Pred Value          0.710    0.658 0.951456 0.981444  0.99658    0.998
## Prevalence              0.502    0.423 0.048502 0.018830  0.00342    0.002
## Detection Rate          0.392    0.210 0.000000 0.000285  0.00000    0.000
## Detection Prevalence    0.621    0.377 0.000856 0.000571  0.00000    0.000
## Balanced Accuracy       0.661    0.603 0.499550 0.507430  0.50000    0.500
##                      Class: 6 Class: 7 Class: 8 Class: 9
## Sensitivity           0.00000 0.000000 0.000000 0.000000
## Specificity           1.00000 1.000000 1.000000 1.000000
## Pos Pred Value            NaN      NaN      NaN      NaN
## Neg Pred Value        0.99843 0.999715 0.999429 0.999857
## Prevalence            0.00157 0.000285 0.000571 0.000143
## Detection Rate        0.00000 0.000000 0.000000 0.000000
## Detection Prevalence  0.00000 0.000000 0.000000 0.000000
## Balanced Accuracy     0.50000 0.500000 0.500000 0.500000
</code></pre>

<p>Accuracy of 0.6036. Again, a bit lower than the benchmark. Reaching the benchmark is likely a matter of parameter tuning.</p>

<p>Finally, I try a gbm model.</p>

<pre><code class="r">set.seed(12)

tunecontrol = trainControl(method = &quot;none&quot;)

tgrid = expand.grid(n.trees = c(100), interaction.depth=c(15) ,shrinkage=c(0.107) )

gbm_mod = train(labels_part~., data=part_train, method=&quot;gbm&quot;, trControl=tunecontrol, tuneGrid=tgrid)
</code></pre>

<pre><code>## Loading required package: plyr
</code></pre>

<pre><code>## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        2.3026             nan     0.1070    0.6953
##      2        1.9114             nan     0.1070    0.3922
##      3        1.6915             nan     0.1070    0.2750
##      4        1.5360             nan     0.1070    0.2016
##      5        1.4228             nan     0.1070    0.1617
##      6        1.3310             nan     0.1070    0.1234
##      7        1.2591             nan     0.1070    0.0990
##      8        1.2016             nan     0.1070    0.0772
##      9        1.1554             nan     0.1070    0.0746
##     10        1.1114             nan     0.1070    0.0558
##     20        0.9061             nan     0.1070    0.0117
##     40        0.7848             nan     0.1070    0.0015
##     60        0.7285             nan     0.1070    0.0008
##     80        0.6896             nan     0.1070   -0.0013
##    100        0.6540             nan     0.1070   -0.0006
</code></pre>

<pre><code class="r">pred_gbm = predict(gbm_mod, newdata=valid)
confusionMatrix(pred_gbm ,valid_labels)
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    0    1    2    3    4    5    6    7    8    9
##          0 2932 1325   55   18    1   13    0    0    1    0
##          1  585 1617  277  111   23    1   10    1    2    1
##          2    1   13    5    2    0    0    0    0    0    0
##          3    0    6    3    1    0    0    1    1    0    0
##          4    0    2    0    0    0    0    0    0    1    0
##          5    0    0    0    0    0    0    0    0    0    0
##          6    0    0    0    0    0    0    0    0    0    0
##          7    0    0    0    0    0    0    0    0    0    0
##          8    0    0    0    0    0    0    0    0    0    0
##          9    0    1    0    0    0    0    0    0    0    0
## 
## Overall Statistics
##                                         
##                Accuracy : 0.65          
##                  95% CI : (0.638, 0.661)
##     No Information Rate : 0.502         
##     P-Value [Acc &gt; NIR] : &lt;2e-16        
##                                         
##                   Kappa : 0.34          
##  Mcnemar&#39;s Test P-Value : NA            
## 
## Statistics by Class:
## 
##                      Class: 0 Class: 1 Class: 2 Class: 3 Class: 4 Class: 5
## Sensitivity             0.833    0.546 0.014706 0.007576 0.000000    0.000
## Specificity             0.595    0.750 0.997601 0.998401 0.999571    1.000
## Pos Pred Value          0.675    0.615 0.238095 0.083333 0.000000      NaN
## Neg Pred Value          0.780    0.693 0.952068 0.981280 0.996575    0.998
## Prevalence              0.502    0.423 0.048502 0.018830 0.003424    0.002
## Detection Rate          0.418    0.231 0.000713 0.000143 0.000000    0.000
## Detection Prevalence    0.620    0.375 0.002996 0.001712 0.000428    0.000
## Balanced Accuracy       0.714    0.648 0.506154 0.502988 0.499785    0.500
##                      Class: 6 Class: 7 Class: 8 Class: 9
## Sensitivity           0.00000 0.000000 0.000000 0.000000
## Specificity           1.00000 1.000000 1.000000 0.999857
## Pos Pred Value            NaN      NaN      NaN 0.000000
## Neg Pred Value        0.99843 0.999715 0.999429 0.999857
## Prevalence            0.00157 0.000285 0.000571 0.000143
## Detection Rate        0.00000 0.000000 0.000000 0.000000
## Detection Prevalence  0.00000 0.000000 0.000000 0.000143
## Balanced Accuracy     0.50000 0.500000 0.500000 0.499929
</code></pre>

<p>Accuracy of 0.6498, beating the benchmark. Increasing n.trees to 2000 gives a validation accuracy of 0.7692.</p>

<p>Rerunning the model on the full training set with the same parameters and submitting the result to Kaggle gives a leaderboard score of 0.81873. Since the extra training data appears to have significantly improved accuracy, generating new training examples or letting the algorithm run longer(more than 2000 trees) may improve accuracy. Since I&#39;m currently at my computer&#39;s 8GB RAM limit so I&#39;m content to let this competition rest with a single submission.</p>

</body>

</html>

