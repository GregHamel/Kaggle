getwd()
setwd(titanic)
setwd("titanic")
getwd()
library(rpart)
library(rpart.plot)
library(caret)
library(randomForest)
library(caTools)
library(mice)
library(gbm)
#Read in the data
train = read.csv("titanic_train.csv")
test = read.csv("titanic_test.csv")
train$Survived = as.factor(train$Survived)
#Create new columns for ship section (first letter listed under cabin)
#Most passengers don't have a cabin listed, but those that do tend to
#Have higher survival rates
train_ship_section = substr(train$Cabin, 1, 1)
test_ship_section = substr(test$Cabin, 1, 1)
train$section = as.factor(train_ship_section)
test$section = as.factor(test_ship_section)
#Split data into cases where age is listed and were age is NA
train_age = subset(train, is.na(Age)==FALSE)
train_no_age = subset(train, is.na(Age)==TRUE)
test_age = subset(test, is.na(Age)==FALSE & is.na(Fare)==FALSE)
test_no_age = subset(test, is.na(Age)==TRUE | is.na(Fare)==TRUE)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare, data=train, cp=0.00000001,minbucket=12, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.00000001,minbucket=12, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.00000001,minbucket=12, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission18 = pred_frame
summary(submission18)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.000001,minbucket=11, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission18 = pred_frame
summary(submission18)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.0001,minbucket=8, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission18 = pred_frame
summary(submission18)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.001,minbucket=8, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission18 = pred_frame
summary(submission18)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.005,minbucket=8, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission18 = pred_frame
summary(submission18)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.008,minbucket=8, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission18 = pred_frame
summary(submission18)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Embarked+section, data=train, cp=0.008,minbucket=8, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission18 = pred_frame
summary(submission18)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp, data=train, cp=0.008,minbucket=8, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission18 = pred_frame
summary(submission18)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp, data=train, cp=0.0001,minbucket=8, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission18 = pred_frame
summary(submission18)
basic_cart = rpart(Survived~ Pclass+Sex+Fare, data=train, cp=0.0001,minbucket=8, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission18 = pred_frame
summary(submission18)
basic_cart = rpart(Survived~ Pclass+Sex+Age+Fare, data=train, cp=0.0001,minbucket=8, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission18 = pred_frame
summary(submission18)
basic_cart = rpart(Survived~ Pclass+Sex+Age+Fare, data=train, cp=0.0001,minbucket=12, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission18 = pred_frame
basic_cart = rpart(Survived~ Pclass+Sex+Age+Fare+SibSp, data=train, cp=0.0001,minbucket=12, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission18 = pred_frame
summary(submission18)
basic_cart = rpart(Survived~ Pclass+Sex+Age+Embarked+section+SibSp, data=train, cp=0.0001,minbucket=12, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission18 = pred_frame
summary(submission18)
basic_cart = rpart(Survived~ Pclass+Sex+Embarked+section+SibSp, data=train, cp=0.0001,minbucket=12, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission18 = pred_frame
summary(submission18)
basic_cart = rpart(Survived~ Pclass+Sex+Embarked+section+SibSp, data=train, cp=0.00001,minbucket=8, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission18 = pred_frame
summary(submission18)
basic_cart = rpart(Survived~ Pclass+Sex+Embarked+Age+section+SibSp, data=train, cp=0.00001,minbucket=8, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission18 = pred_frame
summary(submission18)
basic_cart = rpart(Survived~ Pclass+Sex+Embarked+Age+section+SibSp, data=train, cp=0.00001,minbucket=14, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission18 = pred_frame
summary(submission18)
write.csv(submission18, "titanic_submission18.csv", row.names=FALSE)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.00000001,minbucket=12, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.0000000001,minbucket=11, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.0000000001,minbucket=12, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.0000000001,minbucket=13, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.0000000001,minbucket=12, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.0001,minbucket=12, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.001,minbucket=12, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.01,minbucket=12, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.001,minbucket=3, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.008,minbucket=3, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.01,minbucket=4, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.01,minbucket=3, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.01,minbucket=5, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
161/(418)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.009,minbucket=5, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.008,minbucket=5, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.009,minbucket=6, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.008,minbucket=6, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.009,minbucket=8, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.009,minbucket=7, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.009,minbucket=6, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.009,minbucket=1, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.001,minbucket=1, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission17 = pred_frame
summary(submission17)
157/148
157/418
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.001,minbucket=2, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission19 = pred_frame
summary(submission19)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.001,minbucket=1, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
submission19 = pred_frame
summary(submission19)
write.csv(submission19, "titanic_submission19.csv", row.names=FALSE)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission19 = pred_frame
summary(submission19)
write.csv(submission19, "titanic_submission19.csv", row.names=FALSE)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.009,minbucket=6, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission19 = pred_frame
summary(submission19)
basic_cart = rpart(Survived~ Pclass+Sex+Age+SibSp+Fare+Parch+Embarked+section, data=train, cp=0.009,minbucket=6, method="class")
cart_pred = predict(basic_cart, newdata=test, type="class")
prp(basic_cart)
pred_frame = data.frame(PassengerId= test$PassengerId , Survived=cart_pred)
submission19 = pred_frame
summary(submission19)
write.csv(submission19, "titanic_submission19.csv", row.names=FALSE)
